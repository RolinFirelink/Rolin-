接着我们进入到我们的Maven的最后一个内容，也是我们的短期技术栈学习的最后一个内容，也就是私服

- nexus服务器安装与启动

我们先来说下我们为什么需要私服，这其实很简单，比如所当我们的多个用户分开开发的时候，此时为了获得其他人开发的资源，这时就需要私服来让他们能够便利地获得其他人构建的模块。

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE22e0bb2db643279ff53ea65a6c896f72.png)

这里要注意的是，我们的私服是要和我们的中央服务器分开的，这时当然的，我们公司的东西怎么能随便放到中央上呢是吧

私服的种类有很多，我们这里要使用的私服的名字为Nexus

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE202c3705f32779ab11709632a6a7b434.png)

其实，对应的资源我们都已经放到学习资料里去了，我们将其拷贝出来然后进行一个解压，接着我们可以看到两个目录

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE5834ead677fa19621456c49422f8d08a.png)

这两个目录，前者是我们的程序启动的执行目录，而后者可以理解是工作空间，其运行之后所有的数据都在里面。然后我们进入第一个目录，点击进入bin目录，接着运行cmd，敲入命令nexus /run nexus，接着等待一段时间后就可以看到我们的服务器已经启动了

其默认的网址是localhost:8081，如果我们想要更改端口号的话，我们可以进入nexus目录下的etc目录，里面有一个properties文件，我们可以在里面更改对应的配置

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEd15a50da3c1ba3b2c32742802a03a5c6.png)

同时在安装路径的bin目录下的nexus.vmoptions文件保存有nexus服务器启动的对应的配置信息，这个了解下就好了

- 仓库分类与手动上传组件

接着我们来讲解下我们的私服存放资源的规则，我们一般会在私服里先创建一个仓库，专门存放从中央下载而来的资源，接着我们再创建若干个仓库用于存放我们程序员自己开发的模块资源，然后将这些仓库全部列到一个仓库组，接着有人需要找对应的资源时就会自动搜索该仓库组，搜索到了就给他，找不到就报没有

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEdf318fb1cd65683e115b2c92036c6bd1.png)

简单来说就是我们会在我们的私服里创建宿主仓库（hosted）、代理仓库（proxy）、仓库组（group）

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEa548a46971a8e44843ec6bd34206f547.png)

然后我们来进行正式的对仓库的操作，首先我们应该要进行登录，那么我们点击右上角的login，到其指定的位置找到密码，登录用户名指定是admin，然后重新设置用户名和密码，我们这里全设置为admin。最后其会问我们要不要允许我们的仓库被匿名访问，我们这里选择不允许

我们进入到对应的私服里，可以看到这里有很多设置，其都对应具体的功能，我们这里将最为重要的功能进行了对应的标注

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE7d08f902e4eda620cf0e7406f2862ed8.png)

然后我们要自己创建一个仓库，我们选择服务器设置，然后选择左边的Repositories，再选择右边的create选项，接着我们选择创建maven3的host仓库，取个名字，然后选择存放的东西是快照还是稳定版本，我们这里选择稳定版本，然后点击创建，接着我们点击进入maven-public，将我们新创建的仓库加入到该仓库组中就可以了

然后我们就要往我们的创建的仓库里存放东西了，我们首先点击Browse，选择我们的仓库，接着我们点击左上方的upload component，进入如下的界面，上传我们的资源

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE1e3d462493f3004854c8b6978d116708.png)

此时我们再点进该仓库我们就可以看到我们这里已经有了我们之前所存放的内容了，原版我们的内容是一个jar包，而在这里我们可以看到我们的jar包被以一个工程格式的方式进行了对应的展示，最后我们要注意的是我们之前如果设置仓库为保存稳定版本的内容，那么其就不会允许我们保存带有快照关键字的文件

- 本地仓库访问私服

接着我们来学习idea中资源的上传与下载，我们的上传需要访问私服的用户名和密码，以及我们需要上传的位置。而我们的下载不但需要前者，还需要下载的地址，idea自然是无法自己连接我们的私服里的仓库，我们一般需要我们的本地仓库作为媒介，也就是我们的maven仓库

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE4f4d23b057b970e04d6e62ea2f5ff96a.png)

接着我们要先设置我们的本地仓库访问私服的用户名的密码，先进行我们的maven仓库中，编辑我们的settings.xml文件，然后在servers标签中写入代码如下，我们这里的id可以随便配置，但是一般来说我们最好和我们的仓库名保持一致

```
	<server>
			<id>heima-release</id>
			<username>admin</username>
			<password>admin</password>
	</server>
	
	<server>
			<id>heima-snapshots</id>
			<username>admin</username>
			<password>admin</password>
	</server>
```

接着我们要配置镜像，我们需要配置什么东西需要从我们的本地仓库中获取，那么我们可以配置我们的代码在mirrors标签如下

```
    <mirror>
        <id>nexus-aliyun</id>
        <mirrorOf>central</mirrorOf>
        <name>Nexus aliyun</name>
        <url>http://maven.aliyun.com/nexus/content/groups/public</url>
    </mirror>
	
	<mirror>
        <id>nexus-heima</id>
        <mirrorOf>*</mirrorOf>
        <url>http://localhost/repository/maven-public/</url>
    </mirror>
```

这里我第二个配置的就是我们现在所配置的，其意味着所有的资源如果中央仓库找不到，或者非中央仓库的资源就会到这里被拦截，然后从我们的私服里去找，这里的私服就是我们的设置的公共仓库组的url

最后别忘了我们的本地仓库中的设置的文件要和我们安装的maven的仓库文件保持一致，因此不要忘了进行一个拷贝覆盖原来的设置文件

- idea访问私服与组件上传

最后我们来看看idea如何将我们的模块上传到我们的私服中，首先我们应该要在配置文件中去配置当前项目访问私服的资源保存位置，那么我们可以写入其代码如下

```
<!--发布配置管理-->
<distributionManagement>
    <repository>
        <id>heima-release</id>
        <url>http://localhost/repository/heima-release/</url>
    </repository>
    <snapshotRepository>
        <id>heima-snapshots</id>
        <url>http://localhost/repository/heima-snapshots/</url>
    </snapshotRepository>
</distributionManagement>
```

我们这里进行了配置管理，在其下我们配置仓库的id和url，这样就可以让我们的项目正确上传到对应的仓库中，我们这里配置了两个，一个是快照版本的仓库，另外一个是稳定版的。

然后我们要上传就直接点击maven选项卡中的deploy选项就可以了，这样其就会自动将对应的资源推送我们的私服里的仓库了