学习完了相关的API之后，接着我们来学习我们的映射配置文件，同样我们先把我们映射配置文件的代码放出来

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="StudentMapper">
    <select id="selectAll" resultType="com.itheima.bean.Student">
        SELECT * FROM student
    </select>
</mapper>
```

- 映射配置文件的介绍

关于映射配置文件中各个语句的作用，我们请看下图

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE32d059e56adf8b6ba2eb7fea9a721fa5.png)

最开头的一行代码指定的配置文件的版本和字符集

后一行代码指定了配置文件的约束，比如说这里我们的mapper标签就是其事先指定好的，包括mapper里的子标签，都是依赖最开头的约束才实现的

后面的mapper里的namespace属性则是用于给核心配置文件指定的一个属性，我们可以理解为是类似于id的唯一标识，其命名规则一般是采用类名+Mapper

我们的resultType指定的映射对象类型，简单来说就是指定数据要封装的对象。而parameterType属性指定参数映射对象类型，说白了就是用于给里面的？占位符赋值的数据的属性

那么最终我们可以将我们的代码增加注释如下

```
<?xml version="1.0" encoding="UTF-8" ?>
<!--MyBatis的DTD约束-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    mapper:核心根标签
    namespace属性：名称空间
-->
<mapper namespace="StudentMapper">
    <!--
        select:查询功能的标签
        id属性：唯一标识
        resultType属性：指定结果映射对象类型
        parameterType属性：指定参数映射对象类型
    -->
    <select id="selectAll" resultType="com.itheima.bean.Student">
        SELECT * FROM student
    </select>
</mapper>
```

- 查询功能的使用

那么学习了简单的映射配置文件的对应语句的说明之后，接着我们在配置文件中实现我们的增删改查四个功能。先来实现根据id查询的功能，先从配置文件开始构造。那么我们可以在映射配置文件中的mapper标签中写入代码如下

```
<select id="selectById" resultType="com.itheima.bean.Student" parameterType="java.lang.Integer">
    SELECT * FROM student WHERE id = #{id}
</select>
```

这里我们要执行根据id查询的语句，需要参数进行赋值，我们这里就需要在parameterType中指定我们的参数的数据类型，当然，如果是基本类型就要改成是包装类。然后我们这里不能占位符？来指代需要传入参数的变量，我们需要用#{}，内部写入的名字可以随意指定，我们这里为了便于阅读就写入id，因为我们是根据id进行查找

然后我们可以在java类中写入代码如下

```
/*
    根据id查询
 */
@Test
public void selectById() throws Exception{
    //1.加载核心配置文件
    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");

    //2.获取SqlSession工厂对象
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);

    //3.通过工厂对象获取SqlSession对象
    SqlSession sqlSession = sqlSessionFactory.openSession();

    //4.执行映射配置文件中的sql语句，并接收结果
    Student stu = sqlSession.selectOne("StudentMapper.selectById", 3);

    //5.处理结果
    System.out.println(stu);

    //6.释放资源
    sqlSession.close();
    is.close();
}
```

我们这里做出的改动就是在第四步和第五步，我们这里调用了selectOne，之所以调用selectOne，因为我们这里得到结果必然是一个的，这个方法是sqlSession中已经提供好了给我们使用的，并且传入了用于查询的id，内部调用了我们刚刚自己构造的查询的sql语句，最后打印该对象

最后我们可以对本小节做个总结

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEf132116319aad13fb01616f8dd7771f0.png)

- 新增功能的使用

接着我们来实现我们的新增功能，首先我们要在配置文件里写入代码如下

```
<insert id="insert" parameterType="com.itheima.bean.Student">
    INSERT INTO student VALUES (#{id},#{name},#{age})
</insert>
```

我们这里实现的是插入功能，由于所有的增删改功能返回的结果都是影响的行数而不是对应数据表内的数据内容，因此我们这里可以省略掉resultType标签。我们这里提供的参数就是我们要插入的整个对象，对象里有三个属性，因此我们在values内部也是用三个语句承载这三个数据

最后我们在java程序中写入代码如下

```
/*
    新增功能
*/
@Test
public void insert() throws Exception{
    //1.加载核心配置文件
    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");

    //2.获取SqlSession工厂对象
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);

    //3.通过工厂对象获取SqlSession对象
    //SqlSession sqlSession = sqlSessionFactory.openSession();
    SqlSession sqlSession = sqlSessionFactory.openSession(true);

    //4.执行映射配置文件中的sql语句，并接收结果
    Student stu = new Student(5,"周七",27);
    int result = sqlSession.insert("StudentMapper.insert", stu);

    //5.提交事务
    //sqlSession.commit();

    //6.处理结果
    System.out.println(result);

    //7.释放资源
    sqlSession.close();
    is.close();
}
```

我们这里其实演示了两种方式，一种手动提交，另一种是自动提交，这两种方式都是可以的。我们这里执行插入语句时，调用了sqlSession中的insert插入方法，然后内部又调用我们自己写入的sql插入配置语句

最后我们可以总结一下

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEaa3a327e8680f417f5dbb4f198e9754d.png)

- 修改功能的使用

那么接着我们来实现修改功能，首先我们将我们的配置文件的代码写入如下

```
<update id="update" parameterType="com.itheima.bean.Student">
    UPDATE student SET name = #{name},age = #{age} WHERE id = #{id}
</update>
```

可以看到我们这里压传入的参数，但是我们这里指定了一个学生类，而且指定了学生类里的id，age，name，这些属性，我们的配置文件运行时会取出我们传入的对应属性并用于执行对应的功能

那么我们可以写入我们的更新代码如下

```
/*
    修改功能
*/
@Test
public void update() throws Exception{
    //1.加载核心配置文件
    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");

    //2.获取SqlSession工厂对象
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);

    //3.通过工厂对象获取SqlSession对象
    SqlSession sqlSession = sqlSessionFactory.openSession();
    //SqlSession sqlSession = sqlSessionFactory.openSession(true);

    //4.执行映射配置文件中的sql语句，并接收结果
    Student stu = new Student(5,"周七",37);
    int result = sqlSession.update("StudentMapper.update",stu);

    //5.提交事务
    sqlSession.commit();

    //6.处理结果
    System.out.println(result);

    //7.释放资源
    sqlSession.close();
    is.close();
}
```

学到这里我们或许也能稍微了解到MyBatis的框架的好处了，就是使用这个框架我们不用关心JDBC的底层的东西，我们只需要关注SQL语句就可以了（其实我完全不这么觉得，说实话还是很麻烦，没有啥改善）

最后我们同样可以做一个总结

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE8ad497f2e3dca2a93dfba3a3e439e22f.png)

- 删除功能的使用

接着我们来实现删除功能，写入配置文件的代码如下

```
<delete id="delete" parameterType="java.lang.Integer">
    DELETE FROM student WHERE id = #{id}
</delete>
```

然后我们写入java代码如下

```
/*
    删除功能
*/
@Test
public void delete() throws Exception{
    //1.加载核心配置文件
    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");

    //2.获取SqlSession工厂对象
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);

    //3.通过工厂对象获取SqlSession对象
    SqlSession sqlSession = sqlSessionFactory.openSession();
    //SqlSession sqlSession = sqlSessionFactory.openSession(true);

    //4.执行映射配置文件中的sql语句，并接收结果
    int result = sqlSession.delete("StudentMapper.delete",5);

    //5.提交事务
    sqlSession.commit();

    //6.处理结果
    System.out.println(result);

    //7.释放资源
    sqlSession.close();
    is.close();
}
```

最后我们可以做一个总结

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEa1003ee63c0b7b43ab4916b3ef3004d3.png)

- 映射配置文件的小结

最后我们对本章节做一个小结

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEf7ea9be3591ac4632fd54046518f6104.png)

