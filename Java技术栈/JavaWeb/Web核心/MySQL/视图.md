学习完了多表操作之后，现在我们来学习新的内容，视图！

- 视图的介绍

那么视图是什么呢？其实视图就是一种虚拟存在的数据表，这个数据表并不会在实际的数据库中存在。

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEbec6b1c6605edf76db942ead5e2da493.png)

那么他又有什么作用呢？我们可以举个例子，假设我们要查询下图中对应城市的对应国家的话，那么我们一定要写一串很长的SQL语法代码，如果我们要再次查询的话，那么又要再次输入，这可太麻烦了。但是有了视图之后，我们就可以将我们第一次查询的表自动封装为一个虚拟存在的数据表，我们可以称之为city_country，那么以后我们还需要查找这种数据的话，我们直接查找这个表就完了，就不用这么麻烦了。

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEe82931a6fd43fb38cd4b64f83402b6cf.png)

简单来说，视图的作用就是提高我们的查询效率。同时，为了接下来的学习，我们要写入一些数据准备，其代码如下

```
-- 创建db5数据库
        CREATE DATABASE db5;

        -- 使用db5数据库
        USE db5;

        -- 创建country表
        CREATE TABLE country(
        id INT PRIMARY KEY AUTO_INCREMENT, -- 国家id
        NAME VARCHAR(30)                        -- 国家名称
        );
        -- 添加数据
        INSERT INTO country VALUES (NULL,'中国'),(NULL,'美国'),(NULL,'俄罗斯');

        -- 创建city表
        CREATE TABLE city(
        id INT PRIMARY KEY AUTO_INCREMENT, -- 城市id
        NAME VARCHAR(30),        -- 城市名称
        cid INT, -- 外键列。关联country表的主键列id
        CONSTRAINT cc_fk1 FOREIGN KEY (cid) REFERENCES country(id)  -- 添加外键约束
        );
        -- 添加数据
        INSERT INTO city VALUES (NULL,'北京',1),(NULL,'上海',1),(NULL,'纽约',2),(NULL,'莫斯科',3);
```

- 视图的创建和查询

先来看看视图的创建语法

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE5d99acbcc9cab365046e2fd37fb13af2.png)

我们创建视图的语法是CREATE VIEW 视图名称[(列名列表)] AS 查询语句，创建的视图的列名我们是可以自由指定的，如果不指定那么就会保持原来的命名。来看看我们的示例代码

```
/*
   创建视图
   标准语法
      CREATE VIEW 视图名称 [(列名列表)] AS 查询语句;
*/
-- 创建city_country视图，保存城市和国家的信息(使用指定列名)
        CREATE VIEW city_country (city_id,city_name,country_name) AS

SELECT
        c1.id,
        c1.name,
        c2.name
FROM
        city c1,
        country c2
WHERE
        c1.cid=c2.id;


   
/*
   查询视图
   标准语法
      SELECT * FROM 视图名称;
*/
        -- 查询视图
        SELECT * FROM city_country;
```

我们上面的代码是先写入了创建视图的命令，然后后面输入了对应的查询命令，我们这里采用了利用回车的方式写入的代码。

我们创建完毕之后往sqlyog的右边看，打开对应数据表的视图文件夹，可以在哪里看到我们创建的视图，如下图所示

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE92a4bbdb2882c0af871ac1e1755a976b.png)

可以看到这个视图的图标有点危险啊，这个触犯到了某一位来自另类时空的智者，我反正先润了。

- 视图的修改和删除

其实，视图的修改和删除跟我们数据表的修改和删除，是大差不差的，这里我们先来看看语法

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE0044c0438eeefb1fb79a4da65d599290.png)

这里我们重点要说下修改视图结构的语法，我们这里修改视图结构，后面要紧跟随一个原来的查询语句，而不是直接跟着原来生成的视图。我觉得可以理解为新生成了一个视图并取代了原来的视图。请看示例代码

```
/*
   修改视图数据
   标准语法
      UPDATE 视图名称 SET 列名=值 WHERE 条件;
   
   修改视图结构
   标准语法
      ALTER VIEW 视图名称 (列名列表) AS 查询语句; 
*/
-- 修改视图数据,将北京修改为深圳。(注意：修改视图数据后，源表中的数据也会随之修改)
        SELECT * FROM city_country;
        UPDATE city_country SET city_name='深圳' WHERE city_name='北京';


        -- 将视图中的country_name修改为name
        ALTER VIEW city_country (city_id,city_name,NAME) AS
SELECT
        c1.id,
        c1.name,
        c2.name
FROM
        city c1,
        country c2
WHERE
        c1.cid=c2.id;


/*
   删除视图
   标准语法
      DROP VIEW [IF EXISTS] 视图名称;
*/
        -- 删除city_country视图
        DROP VIEW IF EXISTS city_country;
```

