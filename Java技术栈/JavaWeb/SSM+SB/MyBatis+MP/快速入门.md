那么本节我们就来学习MyBatis框架，这是我们在JDBC之后学习的更加进一步的内容。首先我们要做对框架的介绍，首先我们要知道到底什么是框架

- 框架的介绍

框架其实就是一款半成品软件，我们可以程序员可以基于这个软件继续开发来完成个性化的定制需求。如果以盖房子为例，那么框架就相当于是房子本身，我们程序员要做的事情就是给房子涂上我们所需要的颜色

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE4d7230c81240de057d5bf861fdf2507f.png)

- ORM介绍

在正式学习MyBatis之前，我们还需要学习ORM。所谓ORM就是Object Relational Mapping的简写，其意为对象关系映射。指的是持久化数据和实体对象的映射模式，其是为了解决面向对象与关系型数据库存在的互不匹配的现象的技术

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEe4b52d3e3ef4b982865fef9de7474321.png)

简单来说就是我们的数据库里的数据表的内容在我们java程序里是要将数据封装为一个对象来表示的，而java里的一个对象里的内容也是要将其数据取出来放到我们对应的数据库里的数据表中的，这个过程靠的就是ORM。这里我们是存在映射规则的，首先我们的一个数据表就代表一个类，比如说我们的Student数据表，在我们的java程序中就是一个Student学生类。而表中的字段就是类的属性，比如我们Studnet数据表中的age字段就代表了学生类中的age属性，而表中的数据则是我们所需要映射到我们的对象中对应的属性的数据

- MyBatis介绍

在正式介绍MyBatis之前，我们要先了解下我们之前的JDBC框架的不足和改进方法，请看下图

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEe0ef7f946e8a5158f0adc1e1b78b0e0a.png)

我们可以看到我们的JDBC存在的问题主要有四点，一是频繁的创建销毁数据库连接造成资源浪费从而影响效率，二是Sql语句是硬编码，不易于维护。三是查询时需要手动封装数据到对象中，四是增删改查涉及到参数是要手动设置数据到？占位符中。这些都是有解释方法的，比如说对于第一点，我们可以使用数据库连接池，第二点可以将sql语句抽取到配置文件中，第三点可以使用反射等技术完成自动封装。但这些实现起来都比较麻烦，有没有一种框架已经帮我们把这些实现好了呢？当然有，这就不得不提我们的MyBatis了

首先我们的MyBatis是一个基于java的持久层框架，内部封装了JDBC，开发者只需要关注SQL语句本身，不需要去处理其他复杂操作。其次是MyBatis通过xml或注解的方式将要执行的Statement配置起来，并通过Java对象和Statment中的SQL动态参数进行映射生成最终要执行的SQL语句。最后是MyBatis框架执行完SQL并将结果映射为Java对象并返回，这里采用了ORM思想，内部对JDBC进行了封装，使我们不必与JDBC打交道就可以完成对数据库的持久化操作

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEb5135c9faf6f05d5608f0a0fb980d2a3.png)

- mybatis入门程序

我们现在做一个入门程序来作为我们对mybatis的学习，这里我们用到的方法先不解释，我们先用着

先来看看步骤

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCE7dec24525161f8f662f579668ac13da4.png)

首先我们要做相关的数据库的数据的准备，我们可以在数据库中创建db1，并创建student数据表，写入数据如下

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEf0aeb928993c57e852a8a39ddce92bfb.png)

请看代码

```
DROP DATABASE db1;
        CREATE DATABASE db1;
        CREATE TABLE student(
        id INT,
        NAME VARCHAR(10),
        age INT
        );
        INSERT INTO student VALUES (1,'张三',23),(2,'李四',24),(3,'王五',25);
        ALTER TABLE student MODIFY id INT PRIMARY KEY AUTO_INCREMENT;
        DESC student;
```

然后我们要创建对应的类，导入对应的jar包，这里我们都假定我们已经做好了。然后我们要在src下创建映射配置文件，这个映射配置文件的名字其实是可以随意指定的，但是我们一般采用类名+Mapper的方式来指定比较好，这样比较有规范。那么我们可以创建并写入代码如下

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="StudentMapper">
    <select id="selectAll" resultType="com.itheima.bean.Student">
        SELECT * FROM student
    </select>
</mapper>
```

最上面的内容是固定的内容，规定了字符集和其他的内容，在我们的资料中有提供，我们直接复制黏贴就完了，后面我们要指定mapper标签，然后我们要写入namespace属性，然后写入对应的select标签，加入id属性，以及赋予将数据映射给对象的对象地址（放在resultType属性中，指定地址就可以了），然后标签内部写入我们对应的sql查询语句，我们这里写入查询全部的sql语句

接着我们还需要在src下创建核心配置文件并写入代码如下

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd">

<configuration>
    <environments default="mysql">
        <environment id="mysql">
            <transactionManager type="JDBC"></transactionManager>
            <dataSource type="POOLED">
                <property name="driver" value="com.mysql.jdbc.Driver"/>
                <property name="url" value="jdbc:mysql://175.178.114.158:3306/db1"/>
                <property name="username" value="root"/>
                <property name="password" value="itheima"/>
            </dataSource>
        </environment>
    </environments>

    <mappers>
        <mapper resource="StudentMapper.xml"/>
    </mappers>
</configuration>
```

这里最上面的也是固定内容，同样提供好了，我们复制黏贴。然后我们要写入configuration标签，然后写入environment子标签，子标签下有default属性，这个属性指的是我们默认采用的配置，比如我们这里填入mysql，那么其默认就会寻找environment标签里id属性为mysql的配置来执行，这也侧面说明了我们可以在这个配置文件下编写多个配置内容。然后我们写入transactionManager标签，type属性我们填写JDBC，然后我们写入dataSource标签，type属性写入POOLED，代表连接池，然后再写入property子标签，标签下的属性name和value，就分别写入我们之前填写过的driver，url，用户名和密码那些就行了

最后我们可以写入测试类并填入代码如下

```
package com.tiheima.dao;

import com.itheima.bean.Student;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class StudentTest01 {
    /*
        查询全部
     */
    @Test
    public void selectAll() throws Exception {
        //1.加载核心配置文件
        InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");

        //2.获取SqlSession工厂对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);

        //3.通过SqlSession工程对象获取SqlSession对象
        SqlSession sqlSession = sqlSessionFactory.openSession();

        //4.执行映射配置文件中的sql语句，并接受结果
        List<Student> list = sqlSession.selectList("StudentMapper.selectAll");

        //5.处理结果
        for (Student stu:list) {
            System.out.println(stu);
        }

        //6.释放资源
        sqlSession.close();
        is.close();
    }
}

```

最后我们可以对我们的快速入门做一个总结

![](D:/Rolin的学习笔记/youdaonote-pull/youdaonote/youdaonote-images/WEBRESOURCEdbc79b80f0f743374d6a170ce53fd967.png)

j